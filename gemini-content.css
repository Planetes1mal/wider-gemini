/* ========== CSS 变量定义 ========== */
:root {
    --gemini-chat-width: 1000px;
}

/* ========== 滚动条位置修复 ========== */
html {
    overflow: auto !important;
    overflow-x: hidden !important;
    overflow-y: auto !important;
}

body {
    overflow: visible !important;
}

/* 确保主容器不会创建独立的滚动上下文 */
/* 只在窗口宽度足够大时应用，避免在小窗口下破坏布局 */
@media screen and (min-width: 960px) {

    mat-sidenav-content,
    .mat-drawer-content {
        overflow: visible !important;
        height: auto !important;
        min-height: 100vh !important;
    }
}

/* ========== 对话容器宽度设置 ========== */
.conversation-container {
    max-width: var(--gemini-chat-width) !important;
}

/* 用户提问区域 - fit-content 自适应内容 */
.conversation-container user-query {
    max-width: 100% !important;
}

/* ========== 输入区域 ========== */
.input-area-container {
    max-width: var(--gemini-chat-width) !important;
    margin-left: auto !important;
    margin-right: auto !important;
}

input-container {
    max-width: var(--gemini-chat-width) !important;
    margin-left: auto !important;
    margin-right: auto !important;
    margin-bottom: 10px !important;
}

/* 聊天容器宽度限制 */
.chat-container {
    max-width: var(--gemini-chat-width) !important;
    margin-left: auto !important;
    margin-right: auto !important;
}

/* 拖拽状态下的容器 */
.chat-container.xap-drag-in-progress {
    max-width: var(--gemini-chat-width) !important;
}

.chat-container.xap-drag-in-progress>* {
    max-width: 100% !important;
}

/* 文件拖放区域宽度限制 */
upload-card,
.upload-card {
    max-width: var(--gemini-chat-width) !important;
}

file-drop-area,
.file-drop-area {
    max-width: 100% !important;
}

/* 拖放区域通用选择器 - 覆盖所有可能的拖放元素 */
[class*="drop"],
[class*="drag"],
[class*="upload"],
[class*="file"],
[class*="drop-zone"],
[class*="drag-over"],
[class*="drop-area"],
[class*="drag-area"] {
    max-width: var(--gemini-chat-width) !important;
}

/* 覆盖层和对话框 */
.cdk-overlay-pane,
.mat-menu-panel,
[role="dialog"] {
    max-width: var(--gemini-chat-width) !important;
}

/* 拖拽状态下的所有子元素 */
.xap-drag-in-progress [class*="drop"],
.xap-drag-in-progress [class*="drag"],
.xap-drag-in-progress [class*="upload"] {
    max-width: 100% !important;
}

/* 文件上传菜单面板宽度限制 */
.mat-menu-panel {
    max-width: var(--gemini-chat-width) !important;
}

/* 隐藏幻觉免责声明 */
hallucination-disclaimer {
    display: none !important;
}

/* ========== 代码区域自动换行 ========== */
/* 代码换行开启时的样式 */
body.code-wrap-enabled pre,
body.code-wrap-enabled pre code {
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    word-break: break-word !important;
    overflow-wrap: break-word !important;
}

/* 针对Gemini的代码容器 */
body.code-wrap-enabled .code-container,
body.code-wrap-enabled .code-container.formatted {
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    word-break: break-word !important;
    overflow-wrap: break-word !important;
    overflow-x: visible !important;
}

/* 代码块容器 */
body.code-wrap-enabled .code-block pre,
body.code-wrap-enabled .code-block code {
    white-space: pre-wrap !important;
    overflow-x: visible !important;
}

/* 确保代码块内部容器也支持换行 */
body.code-wrap-enabled .formatted-code-block-internal-container pre,
body.code-wrap-enabled .formatted-code-block-internal-container code {
    white-space: pre-wrap !important;
}

/* 代码换行关闭时保持原样（默认） */
body:not(.code-wrap-enabled) pre,
body:not(.code-wrap-enabled) pre code {
    white-space: pre !important;
    overflow-x: auto !important;
}

body:not(.code-wrap-enabled) .code-container,
body:not(.code-wrap-enabled) .code-container.formatted {
    white-space: pre !important;
    overflow-x: auto !important;
}